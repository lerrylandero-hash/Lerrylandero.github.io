<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InNova - Tu Guía Digital</title>
    <!-- Incluyendo Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluyendo Google Fonts para la fuente "Inter" -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .card {
            background-color: white;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn {
            background-color: #2563eb;
            color: white;
            padding: 12px 24px;
            border-radius: 9999px;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .loading::after {
            content: '';
            width: 30px;
            height: 30px;
            border: 4px solid #d1d5db;
            border-top-color: #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .chat-bubble {
            max-width: 80%;
            padding: 12px;
            border-radius: 1.25rem;
            margin-bottom: 8px;
        }
        .chat-user {
            background-color: #d1d5db;
            color: #1f2937;
            align-self: flex-end;
            border-bottom-right-radius: 0;
        }
        .chat-ai {
            background-color: #2563eb;
            color: white;
            align-self: flex-start;
            border-bottom-left-radius: 0;
        }
        /* Estilos para el efecto de sombra en los botones del menú */
        .menu-btn {
            background-color: #4f46e5;
            color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .menu-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div class="container mx-auto max-w-2xl">

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-2">InNova</h1>
            <p class="text-lg md:text-xl text-gray-600">Tu guía interactiva de seguridad digital</p>
        </header>

        <!-- Main content area -->
        <main class="card p-8">

            <!-- Welcome/Menu Screen -->
            <div id="main-menu-screen" class="text-center">
                <p class="text-lg mb-6 text-gray-700">Explora los diferentes módulos y aprende a navegar por el mundo digital de forma segura.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                    <button class="menu-btn p-6" data-target="ciberacoso">
                        <span class="block text-2xl font-bold">Ciberacoso</span>
                        <p class="text-sm mt-2 opacity-80">Aprende a identificarlo y a protegerte.</p>
                    </button>
                    <button class="menu-btn p-6" data-target="phishing">
                        <span class="block text-2xl font-bold">Phishing</span>
                        <p class="text-sm mt-2 opacity-80">Evita ser víctima de estafas en línea.</p>
                    </button>
                    <button class="menu-btn p-6" data-target="contenido-inapropiado">
                        <span class="block text-2xl font-bold">Contenido Inapropiado</span>
                        <p class="text-sm mt-2 opacity-80">Reconoce y evita material ofensivo o peligroso.</p>
                    </button>
                    <button class="menu-btn p-6" data-target="chat-ia">
                        <span class="block text-2xl font-bold">Chat con la IA</span>
                        <p class="text-sm mt-2 opacity-80">Pregúntale a nuestra IA sobre cualquier tema de seguridad.</p>
                    </button>
                </div>
            </div>

            <!-- Themed Content Screens -->
            <div id="ciberacoso" class="hidden">
                <h2 class="text-3xl font-bold mb-4">Ciberacoso</h2>
                <p class="text-gray-700 leading-relaxed">
                    El ciberacoso es el uso de tecnologías digitales para acosar, intimidar, amenazar o humillar a otra persona. Esto puede incluir el envío de mensajes o correos electrónicos agresivos, la publicación de rumores en redes sociales, o la creación de perfiles falsos.
                </p>
                <ul class="list-disc list-inside mt-4 text-gray-700">
                    <li>Bloquea al acosador.</li>
                    <li>Guarda las pruebas (capturas de pantalla, mensajes).</li>
                    <li>Habla con un adulto de confianza o un docente.</li>
                </ul>
                <button class="back-btn btn mt-8">Volver</button>
            </div>

            <div id="phishing" class="hidden">
                <h2 class="text-3xl font-bold mb-4">Phishing</h2>
                <p class="text-gray-700 leading-relaxed">
                    El phishing es una técnica de estafa digital que busca engañarte para que reveles información personal, como contraseñas o datos bancarios. Generalmente, se hace a través de correos electrónicos, mensajes de texto o sitios web que parecen ser legítimos.
                </p>
                <ul class="list-disc list-inside mt-4 text-gray-700">
                    <li>Revisa la dirección de correo del remitente.</li>
                    <li>Desconfía de enlaces o archivos adjuntos sospechosos.</li>
                    <li>Nunca compartas información sensible.</li>
                </ul>
                <button class="back-btn btn mt-8">Volver</button>
            </div>

            <div id="contenido-inapropiado" class="hidden">
                <h2 class="text-3xl font-bold mb-4">Contenido Inapropiado</h2>
                <p class="text-gray-700 leading-relaxed">
                    El contenido inapropiado se refiere a cualquier material en línea que es ofensivo, dañino o no adecuado para todos los públicos. Esto puede incluir violencia, discriminación, lenguaje de odio o material sexual.
                </p>
                <ul class="list-disc list-inside mt-4 text-gray-700">
                    <li>No lo compartas ni lo distribuyas.</li>
                    <li>Bloquea al usuario que lo compartió.</li>
                    <li>Repórtalo a la plataforma o a un adulto.</li>
                </ul>
                <button class="back-btn btn mt-8">Volver</button>
            </div>

            <!-- AI Chat Screen -->
            <div id="chat-ia" class="hidden">
                <h2 class="text-3xl font-bold mb-4">Chat con la IA</h2>
                <div id="chat-container" class="bg-gray-100 p-4 rounded-xl h-96 overflow-y-auto flex flex-col mb-4">
                    <div class="chat-bubble chat-ai">Hola, soy la IA de InNova. ¿En qué tema de seguridad digital puedo ayudarte hoy?</div>
                </div>
                <div class="flex items-center">
                    <input type="text" id="chat-input" class="flex-grow p-3 rounded-l-xl border-t border-b border-l border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Escribe tu pregunta...">
                    <button id="send-chat-btn" class="btn rounded-l-none">Enviar</button>
                </div>
            </div>

        </main>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const API_KEY = "AIzaSyBOy6ZIMToC6OewYmoDBnDIWqY3MPBHSjU"; 
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
            
            // Referencias a las pantallas
            const mainMenuScreen = document.getElementById('main-menu-screen');
            const ciberacosoScreen = document.getElementById('ciberacoso');
            const phishingScreen = document.getElementById('phishing');
            const contenidoInapropiadoScreen = document.getElementById('contenido-inapropiado');
            const chatIaScreen = document.getElementById('chat-ia');
            
            // Referencias a los botones
            const menuButtons = document.querySelectorAll('.menu-btn');
            const backButtons = document.querySelectorAll('.back-btn');
            const sendChatBtn = document.getElementById('send-chat-btn');
            const chatInput = document.getElementById('chat-input');
            const chatContainer = document.getElementById('chat-container');

            // Historial del chat para el modelo de IA
            let chatHistory = [
                { role: "user", parts: [{ text: "Actúa como un tutor experto y amigable en ciberseguridad para estudiantes. No respondas preguntas fuera de este tema." }] },
                { role: "model", parts: [{ text: "¡Hola! Estoy listo para responder tus preguntas sobre seguridad digital." }] }
            ];

            const showScreen = (screenId) => {
                const screens = [mainMenuScreen, ciberacosoScreen, phishingScreen, contenidoInapropiadoScreen, chatIaScreen];
                screens.forEach(screen => screen.classList.add('hidden'));
                document.getElementById(screenId).classList.remove('hidden');
            };

            const addMessageToChat = (message, sender) => {
                const messageBubble = document.createElement('div');
                messageBubble.textContent = message;
                messageBubble.className = `chat-bubble ${sender === 'user' ? 'chat-user' : 'chat-ai'}`;
                chatContainer.appendChild(messageBubble);
                chatContainer.scrollTop = chatContainer.scrollHeight; // Scroll to bottom
            };

            const sendUserMessage = async () => {
                const userMessage = chatInput.value.trim();
                if (userMessage === "") return;

                addMessageToChat(userMessage, 'user');
                chatInput.value = '';
                sendChatBtn.disabled = true;

                // Añadir el mensaje del usuario al historial
                chatHistory.push({ role: "user", parts: [{ text: userMessage }] });

                // Llamada a la API de Gemini
                try {
                    const payload = {
                        contents: chatHistory,
                    };
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload),
                    });

                    if (!response.ok) {
                        throw new Error("Error en la respuesta de la API.");
                    }

                    const data = await response.json();
                    const aiResponse = data.candidates[0].content.parts[0].text;
                    addMessageToChat(aiResponse, 'ai');
                    chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });

                } catch (error) {
                    console.error("Error al comunicarse con la IA:", error);
                    addMessageToChat("Lo siento, no pude procesar tu solicitud. Por favor, intenta de nuevo.", 'ai');
                } finally {
                    sendChatBtn.disabled = false;
                }
            };

            // Eventos para los botones del menú
            menuButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetId = button.dataset.target;
                    showScreen(targetId);
                });
            });

            // Eventos para los botones de volver
            backButtons.forEach(button => {
                button.addEventListener('click', () => {
                    showScreen('main-menu-screen');
                });
            });

            // Evento para enviar mensaje en el chat
            sendChatBtn.addEventListener('click', sendUserMessage);
            chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    sendUserMessage();
                }
            });
        });
    </script>
</body>
</html>
